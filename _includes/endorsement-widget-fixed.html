<!-- Endorsement Widget -->
<div class="endorsement-widget">
  <h3>Community Endorsements</h3>
  <div id="widget-stats">
    <p>Loading endorsement count...</p>
  </div>
  <p>
    <a href="/endorsement/" class="btn btn-primary">
      Endorse this Proposal
    </a>
  </p>
</div>

<script>
(function() {
  const proposalId = 'neutron-instrument-2026';
  const workerUrl = 'https://orcid-endorsement-worker-production.excitations-org.workers.dev';
  
  fetch(`${workerUrl}/api/stats?proposal_id=${proposalId}`)
    .then(response => response.json())
    .then(data => {
      const statsDiv = document.getElementById('widget-stats');
      if (statsDiv && data.total !== undefined) {
        statsDiv.innerHTML = `
          <p class="endorsement-count">${data.total}</p>
          <p>researcher${data.total !== 1 ? 's' : ''} ${data.total !== 1 ? 'have' : 'has'} endorsed this proposal</p>
        `;
      }
    })
    .catch(error => {
      console.error('Failed to load endorsement count:', error);
    });
})();
</script>
